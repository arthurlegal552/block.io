<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8" />
<title>Three.js + OrbitControls + Modelo Animado</title>
<!-- Import Map para definir onde buscar os módulos -->
<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.150.1/build/three.module.js",
    "three/addons/": "https://unpkg.com/three@0.150.1/examples/jsm/"
  }
}
</script>
</head>
<body style="margin:0; overflow:hidden;">
<script type="module">
import * as THREE from 'three';
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

// Cena e Câmera
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(
  75,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.set(3, 3, 5);

// Textura de fundo
const loader = new THREE.TextureLoader();
const texture = loader.load('./space.jpg'); // Sua imagem de fundo
scene.background = texture;

// Renderer
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// OrbitControls
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

// Cubo simples
const cube = new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshNormalMaterial());
scene.add(cube);

// Plano e Grid
const planeGeometry = new THREE.PlaneGeometry(30, 30);
const planeMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff, side: THREE.DoubleSide });
const plane = new THREE.Mesh(planeGeometry, planeMaterial);
scene.add(plane);
plane.rotation.x = 0.5 * Math.PI;

const gridHelper = new THREE.GridHelper(30);
scene.add(gridHelper);

// Esfera
const sphereGeometry = new THREE.SphereGeometry(4, 10, 10);
const sphereMaterial = new THREE.MeshBasicMaterial({ color: 0x0000ff, wireframe: true });
const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
scene.add(sphere);
sphere.position.x = -10;

// ⚡️ Modelo Animado (.gltf / .glb) ⚡️
let mixer;

const gltfLoader = new GLTFLoader();
gltfLoader.load('./behemot_cat.glb', (gltf) => {
  scene.add(gltf.scene);

  // Ativa animações
  mixer = new THREE.AnimationMixer(gltf.scene);
  const animations = gltf.animations;

  if (animations.length > 0) {
    const action = mixer.clipAction(animations[0]);
    action.play();
  }
});

// Animação
const clock = new THREE.Clock();

function animate() {
  requestAnimationFrame(animate);

  controls.update();
  cube.rotation.x += 0.01;
  cube.rotation.y += 0.01;

  // Atualização do modelo animado
  if (mixer) {
    const delta = clock.getDelta();
    mixer.update(delta);
  }

  renderer.render(scene, camera);
}
animate();

// Redimensionamento
window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
